# [CVE-2025-26201] - GreaterWMS - Authentication Bypass via Credential Disclosure
#### Exploit Author: [Aurelien BOURDOIS](https://www.linkedin.com/in/aurelien-bourdois)
#### Date: 02/01/2025
#### Vendor: [GreaterWMS](https://github.com/GreaterWMS/GreaterWMS)
#### Issue: [Issue 383](https://github.com/GreaterWMS/GreaterWMS/issues/383)
#### Vulnerable Version :
- GreaterWMS <= 2.1.49

## Description:
Credential disclosure vulnerabilty via the `/staff` route in **GreaterWMS <= 2.1.49** allows a remote unauthenticated attackers to bypass authentication and escalate privileges.

## Steps to Reproduce

1. Go to the main page
2. Intercept flaws with a tool like BurpSuite
3. Insert random username and password, then press `Login` button
![Image](https://github.com/user-attachments/assets/8b1cc90d-fc95-4135-bf06-29e6fee0d6ad)
>  It is possible to retrieves all the OPENID availables (warehouse id) with the `/warehouse/multiple` GET request, even unauthenticated. Users are grouped by warehouse.
4. On this interception, we can see that the OPENID value automatically inserted on the connection page appears in the `token` header.
![Image](https://github.com/user-attachments/assets/d1d861a9-8910-4281-b5d1-150f79bf5895)

5. Put this request in the repeater, and then delete the `staff_name` and `check_code` parameters/values. It is then possible to retrieve all the users of this Center Warehouse (Token / OPENID value).
![Image](https://github.com/user-attachments/assets/9ce34f16-28ee-4ce0-a281-c0cb23adff71)

6. If we wish, we can then filter using the `staff_name` and `staff_type` parameters.
![Image](https://github.com/user-attachments/assets/aa5f47f7-a2c8-4603-ba6f-1016349b2ccf)

7. The attacker must then choose the user to impersonate, taking the values staff_name and check_code and placing them in the intercepted request.
![Image](https://github.com/user-attachments/assets/59e3db63-c8ec-417d-b2b5-0c2eec57287a)

8. By sending this request, which had been intercepted during the authentication phase, the attacker is then authenticated as the chosen user.
![Image](https://github.com/user-attachments/assets/d3f1598d-001d-4574-a430-efa3497d9aa5)

## Impact:
An unauthenticated attacker can impersonate all users.
